@use "../utilities/colours";
@use "../utilities/variables";
@use "../utilities/typography";
@use "../mixins/buttonGradient";
@use "../mixins/pseudo";

form {
    $borderWidth: 0.4rem;
    position: relative;
    z-index: 1;

    @each $prop, $val in map-get(map-get(typography.$styles, "p"), "style") {
        #{$prop}: $val;
    }

    > div {
        //form field container
        display: flex;
        position: relative;
        flex-direction: column;
        row-gap: 1rem;

        & > div.contact-input-wrap {
            position: relative;

            > input {
                max-width: 40rem;
            }

            > input,
            > textarea {
                @each $prop,
                    $val in map-get(map-get(typography.$styles, "p"), "style")
                {
                    #{$prop}: $val;
                }
                position: relative;
                z-index: 1;
                margin: 0;
                outline: none;
                border: none;
                border-radius: 1rem;
                padding: 0.4rem 0.4rem;
                width: 100%;
            }

            &:before {
                @include buttonGradient.buttonGradientMixin();
                @include pseudo.pseudoMixinAbsolute(
                    $left: $borderWidth * -1,
                    $width: calc(100% + ($borderWidth * 2)),
                    $top: $borderWidth * -1,
                    $height: calc(100% + ($borderWidth * 2))
                );
                border-radius: calc(1rem + #{$borderWidth});
            }

            &:hover,
            &:has(:focus, :focus-within, :active) {
                &:before {
                    background-position: 100% 0;
                }
            }
        }
    }

    .contact-feedback-container {
        overflow: visible !important;
    }

    .contact-tooltip,
    .contact-feedback {
        //width: max-content;
        max-width: 100%;

        > div {
            position: relative;
            column-gap: 0.4rem;
            z-index: 1;
            border-radius: 1rem;
            background: var(--dark);
            padding: 0.4rem 0.8rem 0.4rem 0.4rem;

            > div.contact-tooltip-icon {
                display: flex;
                position: relative;
                align-items: center;
                justify-content: center;
                transform: translateY(-0.1rem);
                width: 2.2rem;
                height: 2.2rem;

                > svg {
                    width: 100%;
                    height: 100%;
                }
            }
        }

        &:before {
            @include pseudo.pseudoMixinAbsolute(
                $left: $borderWidth * -1,
                $width: calc(100% + ($borderWidth * 2)),
                $top: $borderWidth * -1,
                $height: calc(100% + ($borderWidth * 2))
            );

            transition: background-image variables.$defaultTransitionDuration
                variables.$defaultEasing;
            z-index: 0;

            border-radius: calc(1rem + #{$borderWidth});
            background-image: linear-gradient(
                71deg in oklab,
                oklch(50% 0.19 15),
                oklch(61% 0.23 32),
                oklch(63% 0.19 31)
            );
            background-size: 100%;
        }
    }

    .contact-tooltip {
        position: absolute;
        top: calc(100% + $borderWidth * 3);
        left: 50%;
        transform: translate(-50%, calc(-100% - $borderWidth * 3));
        transition-duration: variables.$defaultTransitionDuration;
        transition-property: opacity, transform;
        transition-timing-function: variables.$defaultEasing;
        opacity: 0;
        z-index: 2;

        &.enter,
        &.enter-done {
            transform: translate(-50%, 0);
            opacity: 1;
        }
    }

    .contact-feedback {
        overflow: visible !important;

        &.no-error:before {
            background-image: buttonGradient.$hdrGradient;
        }
    }
}
